<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>ASL Translator</title>
    </head>
    <body>
        <h1>ASL Translator</h1>
        <!-- start/stop recording here   -->
         <section id="video_section">
            <h2>Live Camera Feed</h2>
            <video id="camera-feed" autoplay playsinline></video>
            <canvas id="snapshot" style="display:none;"></canvas>
            <button id="start_recording">Start Recording</button>
            <button id="stop_recording" disabled>Stop Recording</button>
         </section>
<!-- 
         <section id="translation_section" style="display:none;">
            <h2>Translation</h2>
            <p id="translation_text">Your ASL Translation will appear here</p>
            <button id="back_to_recording">Back to Recording</button>
         </section> -->

         <script>
            const startButton = document.getElementById('start_recording');
            const stopButton = document.getElementById('stop_recording');
            const video = document.getElementById('camera-feed');
            const canvas = document.getElementById('snapshot');
            const ctx = canvas.getContext('2d');

            navigator.mediaDevices.getUserMedia({ vidoe: true})
                .then((stream) => {
                    video.srcObject = stream;
                })
                .catch((err) => {
                    console.error("Error accessing camera: ", err);
                });

            startButton.addEventListener('click', () => {
                startButton.disabled = true;
                stopButton.disabled = false;
                console.log("Recording started.");
            });

            stopButton.addEventListener('click', () => {
                startButton.disabled = false;
                stopButton.disabled = true;

                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
                const imageData = canvas.toDataURL('image/png');

                fetch('/upload_snapshot', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({image: imageData}),
                })
                    .then((response) => response.json())
                    .then((data) => {
                        console.log("Snapshot saved: ", data);
                    })
                    .catch((err) => {
                        console.error("Error saving snapshot: ", err);
                    });
                console.log("Recording stopped.");
            });
            
         </script>
    </body>
</html>